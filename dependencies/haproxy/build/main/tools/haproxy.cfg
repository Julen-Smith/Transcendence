defaults
  mode http
  timeout client 10s
  timeout connect 5s
  timeout server 10s 
  timeout http-request 10s

frontend http
    bind *:80
    mode http

    # if this is an ACME request to proof the domain ownder, then redirect to nginx-certbot server
    #acl is_well_known path_beg -i /.well-known/

    # else redirect the traffic to https
    redirect scheme https code 301
    default_backend nginx_backend

frontend https
    bind *:443 ssl crt /etc/certs/ikerketa.com.pem
    http-response set-header Strict-Transport-Security "max-age=16000000; includeSubDomains; preload;"
    default_backend nginx_backend

backend nginx_backend
  server nginx1 nginx:80
